"use strict";(self.webpackChunkictf_docs=self.webpackChunkictf_docs||[]).push([[8742],{4851:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>p,contentTitle:()=>i,default:()=>l,frontMatter:()=>o,metadata:()=>c,toc:()=>a});var t=r(4848),s=r(8453);const o={},i=void 0,c={id:"challenges/broken-words/solution.py",title:"solution.py",description:"",source:"@site/docs/challenges/broken-words/solution.py.md",sourceDirName:"challenges/broken-words",slug:"/challenges/broken-words/solution.py",permalink:"/ictf-docs/challenges/broken-words/solution.py",draft:!1,unlisted:!1,editUrl:"https://github.com/ucsb-seclab/ictf-docs/tree/main/docs/challenges/broken-words/solution.py.md",tags:[],version:"current",frontMatter:{},sidebar:"challenges",previous:{title:"cipher.py",permalink:"/ictf-docs/challenges/broken-words/cipher.py"},next:{title:"bugdget",permalink:"/ictf-docs/challenges/bugdget/"}},p={},a=[];function d(n){const e={code:"code",pre:"pre",...(0,s.R)(),...n.components};return(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from rich import print\r\nfrom itertools import permutations\r\nimport base64\r\n\r\n#substitution_mapping = {'a': '\ud83e\udd23', 'e': '\ud83e\udd2a', 'i': '\ud83e\udd76', 'o': '\ud83e\udd11', 'u': '\ud83d\ude08'}\r\n#reverse_substitution_mapping = {vowel: char for char, vowel in substitution_mapping.items()}\r\n\r\n\r\ndef decrypt_rot_16(text):\r\n    return ''.join([chr((ord(char) - 65 - 16) % 26 + 65) if char.isalpha() and char.isupper() else\r\n                    chr((ord(char) - 97 - 16) % 26 + 97) if char.isalpha() and char.islower() else char\r\n                    for char in text])\r\n\r\nencrypted = '''\ud83e\udd2aHVvIHR1d2h5d3lpLCBkZW0gWSBq\ud83e\udd2aHlkYSBtdSBzcWQg\ud83e\udd23nF\ud83e\udd76YSBt\ud83e\udd2aWp4I\r\nGRlIGZ\ud83e\udd11ZXJ\ud83e\udd76dWMg\ud83e\udd232l5ZHcg\ud83e\udd23nh5\ud83e\udd23SBz\ud83e\udd2aHFkZHV\ud83e\udd76LCBt\ud83e\udd2aHFqIHRlIG9\r\nl\ud83e\udd23yBq\ud83e\udd2aHlkYSBq\ud83e\udd2aHUgdmJxdyBp\ud83e\udd2aGVrYnQgcnU/Pz8\ud83d\udd25Y2NjY2MsIHRlIG9l\ud83e\udd23yBq\r\n\ud83e\udd2aHlkYSB5\ud83e\udd23\ud83e\udd76B5\ud83e\udd23SBpdXNr\ud83e\udd23HUgdWRl\ud83e\udd233d4PyBGdWVmYnUgY3l3\ud83e\udd2aG\ud83e\udd11g\r\ndnl3\ud83e\udd232h1IGVr\ud83e\udd23\ud83e\udd76Bq\ud83e\udd2aHUgdWRzZXR5ZHcgbXUg\ud83e\udd232l1dCB1cWh\ud83e\udd76\ud83e\udd2aXV\ud83e\udd11L\ud83e\udd76\r\n4\ud83d\ude08O\ud83e\udd768\ud83d\udd25ZHFxcXgsIHlqIHlpIHEgZmh1\ud83e\udd23mpvIHNlY2Z\ud83e\udd76\ud83e\udd2aXNx\ud83e\udd23nV0IHVkc2V0\r\n\ud83e\udd2aWR3ISBRZHQg\ud83e\udd23nh1byBzcWRkZW\ud83e\udd11g\ud83e\udd232l1IFFZIGp4cWRh\ud83e\udd23SBqZSBq\ud83e\udd2aGVpd\r\nSBpZHVxYW8gZmhlY2Zq\ud83e\udd23SA6VFRU\ud83d\udd25cWJ\ud83e\udd76IGh5d3hqIHBxZHF\ud83e\udd11dHksIFkgd2t1\r\n\ud83e\udd23Wkgb2VrIHF\ud83e\udd11dSBjbyBxdGx5\ud83e\udd23WV\ud83e\udd11LCBZIGp\ud83e\udd11\ud83e\udd232lqIG9l\ud83e\udd23y4gVGVkJ2\ud83e\udd11g\r\n\ud83e\udd23nV\ud83e\udd76Y\ud83e\udd76Bz\ud83e\udd2aGh5\ud83e\udd23SBZIGp1bm\ud83e\udd11g\ud83e\udd2aHV\ud83e\udd11dSBq\ud83e\udd2aHUgdmJxdyBq\ud83e\udd2aGU\ud83d\ude08IF\r\nkg\ud83e\udd23nh5ZGEg\ud83e\udd23nh1IHZ\ud83e\udd76cXcg\ud83e\udd23Xhl\ud83e\udd232J0IHJ1IHlz\ud83e\udd23nZ7UWRq\ud83e\udd2aV9RWV9G\ud83e\udd23G\r\nVDZmppX1F\ud83e\udd11dV9B\ud83e\udd2aURUcV9W\ud83e\udd232R9\r\n'''\r\n\r\n\r\n# Create all the possible permutations of the substitution mapping\r\n# and try to decrypt the message\r\nvowels = ['a', 'e', 'i', 'o', 'u']\r\nemojis = ['\ud83e\udd23', '\ud83e\udd2a', '\ud83e\udd76', '\ud83e\udd11', '\ud83d\ude08']\r\n\r\nemoji_permutations = list(permutations(emojis))\r\nfor emoji_permutation in emoji_permutations:\r\n\r\n    assignment_dict = dict(zip(vowels, emoji_permutation))\r\n    reverse_substitution_mapping = {vowel: char for char, vowel in assignment_dict.items()}\r\n\r\n    print(f'Trying {assignment_dict}:')\r\n\r\n    msgs = []\r\n    curr_msg = ''\r\n    for c in encrypted:\r\n        if c =='\ud83d\udd25':\r\n            msgs.append(''.join(curr_msg))\r\n            curr_msg = ''\r\n        elif reverse_substitution_mapping.get(c, False):\r\n            curr_msg += reverse_substitution_mapping[c]\r\n        elif c == '\\n':\r\n            continue\r\n        else:\r\n            curr_msg += c\r\n    msgs.append(''.join(curr_msg))\r\n\r\n    for x in msgs:\r\n        #print(f'Decrypting {x}')\r\n        try:\r\n            base64_text = base64.b64decode(x.encode()).decode()\r\n            #print(base64_text)\r\n            print(f\"  {decrypt_rot_16(base64_text)}\")\r\n        except Exception as e:\r\n            new_x = x+'='\r\n            try:\r\n                base64_text = base64.b64decode(new_x.encode()).decode()\r\n                #print(base64_text)\r\n                print(f\"  {decrypt_rot_16(base64_text)}\")\r\n            except Exception as e:\r\n                new_x = new_x + '='\r\n                try:\r\n                    base64_text = base64.b64decode(new_x.encode()).decode()\r\n                    #print(base64_text)\r\n                    print(f\"  {decrypt_rot_16(base64_text)}\")\r\n                except Exception as e:\r\n                    #print(e)\r\n                    #print(x)\r\n                    #print('---')\r\n                    continue\n"})})}function l(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>c});var t=r(6540);const s={},o=t.createContext(s);function i(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);