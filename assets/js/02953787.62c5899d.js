"use strict";(self.webpackChunkictf_docs=self.webpackChunkictf_docs||[]).push([[7994],{7851:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>h});var c=s(4848),t=s(8453);const a={title:"Snake Game",sidebar_custom_props:{levels:["UG"]}},r=void 0,i={id:"challenges/snake-game/index",title:"Snake Game",description:"This snake game has an easter egg, which can be triggered by pressing certain arrow keys and pausing the game.",source:"@site/docs/challenges/snake-game/index.md",sourceDirName:"challenges/snake-game",slug:"/challenges/snake-game/",permalink:"/ictf-docs/challenges/snake-game/",draft:!1,unlisted:!1,editUrl:"https://github.com/ucsb-seclab/ictf-docs/tree/main/docs/challenges/snake-game/index.md",tags:[],version:"current",frontMatter:{title:"Snake Game",sidebar_custom_props:{levels:["UG"]}},sidebar:"challenges",previous:{title:"rustyneurone",permalink:"/ictf-docs/challenges/rustyneurone/"},next:{title:"check.c",permalink:"/ictf-docs/challenges/snake-game/check.c"}},o={},h=[];function l(e){const n={a:"a",code:"code",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.p,{children:"This snake game has an easter egg, which can be triggered by pressing certain arrow keys and pausing the game."}),"\n",(0,c.jsx)(n.p,{children:"Once the player presses the correct key sequence, the flag of the challenge will show up."}),"\n",(0,c.jsxs)(n.p,{children:["Specifically, in ",(0,c.jsx)(n.code,{children:"snake.js"}),", we can see:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-JavaScript",children:"const wasmModule = typeof Module === 'function' ? Module() : Module;\r\nconst checkFunction = wasmModule.cwrap('check', 'string', ['string']);\r\nconst result = checkFunction(moves);\n"})}),"\n",(0,c.jsxs)(n.p,{children:["These lines pass the current moves to the ",(0,c.jsx)(n.code,{children:"check"})," function from wasm, which is compiled webassembly binary code. There are many ways to reverse engineer the wasm binary code (",(0,c.jsx)(n.code,{children:"check.wasm"}),"). One way is to use the ",(0,c.jsx)(n.a,{href:"https://github.com/WebAssembly/wabt/blob/main/wasm2c/README.md",children:"wasm2c"})," tool from ",(0,c.jsx)(n.a,{href:"https://github.com/WebAssembly/wabt/tree/main",children:"wabt"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"wasm2c check.wasm -o check.c\n"})}),"\n",(0,c.jsxs)(n.p,{children:["By reverse engineering the decompiled C file, we can see that the input length should be 80 (the check is performed in ",(0,c.jsx)(n.code,{children:"w2c_check_check_0"}),"). Afterward, the input is encrypted using RC4 with a pre-defined key, and the encrypted input is compared with a pre-defined set of values. To get the expected input, we just do RC4 decryption using the same key. See ",(0,c.jsx)(n.code,{children:"sol.c"})," for an example solution."]}),"\n",(0,c.jsxs)(n.p,{children:["After the decryption, we get the expected input, which is ",(0,c.jsx)(n.code,{children:"RDLURDLURDLURDLURDLURDLURDLURDLURDLURDLULDRULDRULDRULDRULDRULDRULDRULDRULDRULDRU"}),". Next, start the game, press the keys according to this sequence, and then press [space] to pause the game. The flag will show up on the screen:"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"img",src:s(1610).A+"",width:"1950",height:"1924"})}),"\n",(0,c.jsxs)(n.p,{children:["We have provided the original source code ",(0,c.jsx)(n.a,{href:"./check.c",children:"check.c"})," for the ",(0,c.jsx)(n.code,{children:"check"})," function as a reference."]})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},1610:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/flag-a880facd3a6ecab591044fce38a1540f.png"},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>i});var c=s(6540);const t={},a=c.createContext(t);function r(e){const n=c.useContext(a);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),c.createElement(a.Provider,{value:n},e.children)}}}]);